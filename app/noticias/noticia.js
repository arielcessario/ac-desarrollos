(function () {    'use strict';    var scripts = document.getElementsByTagName("script");    var currentScriptPath = scripts[scripts.length - 1].src;    angular.module('ac.noticia', ['ngRoute'])        .config(['$routeProvider', function ($routeProvider) {            $routeProvider.when('/noticia/:id', {                templateUrl: currentScriptPath.replace('.js', '.html'),                controller: 'NoticiaController',                data: {requiresLogin: false}            });        }])        .controller('NoticiaController', NoticiaController);    NoticiaController.$inject = ['NoticiasService', '$routeParams', '$location'];    function NoticiaController(NoticiasService, $routeParams, $location) {        var vm = this;        vm.fecha = new Date();        vm.id = $routeParams.id;        vm.noticia = {};        vm.saveComentario = saveComentario;        vm.anio = vm.fecha.getFullYear();        vm.mes = '' + vm.fecha.getMonth();        vm.fotoSelected = '';        vm.user = {data:{rol:0}};        vm.borrarComentario = borrarComentario;        function borrarComentario(index){            NoticiasService.deleteComentario(vm.noticia.comentarios[index].noticia_comentario_id, function(data){                console.log(data);                vm.noticia.comentarios.splice(index,1);            })        }        if (vm.id > 0) {            NoticiasService.getNoticiaByID(vm.id, function (data) {                vm.noticia = data;                vm.fotoSelected = (data.fotos[0] == undefined)?'':data.fotos[0].foto;            });        }        function saveComentario() {            var comentario = {                noticia_id: vm.noticia.noticia_id,                noticia_comentario_id: -1,                titulo: '',                detalles: vm.comentario,                parent_id: 0,                creador_id: 0,                //creador_id: vm.user.data.userId,                creador: [{mail: vm.user.data.userName}],                votos_up: 0,                votos_down: 0,                fecha: (new Date()).getFullYear() + '-' + ((new Date()).getMonth() + 1) + '-' + (new Date()).getDate()            };            NoticiasService.saveComentario(comentario, 'saveComentario', function (data) {                console.log(data);                comentario.noticia_comentario_id = data;                vm.noticia.comentarios.push(comentario);            });        }    }})();